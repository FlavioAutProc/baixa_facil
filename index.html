<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>StockTrack - Registro de Retiradas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- HEADER -->
        <header class="app-header">
            <div class="header-title">
                <i class="fas fa-boxes-stacked"></i>
                <span>StockTrack - Retiradas</span>
            </div>
            <div class="header-subtitle">Controle de Materiais</div>
        </header>

        <!-- CONTEÚDO PRINCIPAL -->
        <main class="main-content">
            <!-- TELA DE REGISTRO -->
            <section id="register-screen" class="screen active">
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-hand-holding"></i>
                        Nova Retirada
                    </h2>
                    
                    <div id="form-alert" class="alert" style="display: none;"></div>
                    
                    <form id="register-form">
                        <div class="form-group">
                            <label class="form-label" for="product-name">Produto *</label>
                            <input type="text" id="product-name" class="form-control" placeholder="Digite o nome do produto" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="barcode">Código de Barras *</label>
                            <div class="d-flex gap-1">
                                <input type="text" id="barcode" class="form-control" placeholder="Digite ou escaneie o código" required>
                                <button type="button" id="scan-btn" class="btn btn-secondary btn-small">
                                    <i class="fas fa-camera"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="quantity">Quantidade *</label>
                            <input type="number" id="quantity" class="form-control" placeholder="0" min="1" max="9999" required>
                            <div class="text-muted" style="font-size: 14px; margin-top: 5px;">Mínimo: 1 | Máximo: <span id="max-quantity-display">9999</span></div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="origin-sector">Setor de Origem *</label>
                            <select id="origin-sector" class="form-control" required>
                                <option value="">Selecione o setor</option>
                                <option value="estoque">Estoque Principal</option>
                                <option value="loja">Loja</option>
                                <option value="producao">Área de Produção</option>
                                <option value="expedicao">Expedição</option>
                                <option value="manutencao">Manutenção</option>
                                <option value="outro">Outro</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label" for="employee">Colaborador *</label>
                            <input type="text" id="employee" class="form-control" placeholder="Nome do colaborador" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label" for="notes">Observações</label>
                            <textarea id="notes" class="form-control" placeholder="Observações adicionais (opcional)" rows="2"></textarea>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-check-circle"></i>
                            Registrar Retirada
                        </button>
                    </form>
                </div>
                
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-history"></i>
                        Última Retirada
                    </h2>
                    <div id="last-registration" class="text-muted text-center">
                        Nenhuma retirada recente
                    </div>
                </div>
            </section>

            <!-- TELA DE REGISTROS -->
            <section id="records-screen" class="screen">
                <div class="summary-card">
                    <div class="summary-row">
                        <div>
                            <div class="summary-title">Itens Retirados Hoje</div>
                            <div class="summary-value" id="total-items">0</div>
                        </div>
                        <div>
                            <div class="summary-title">Total de Registros</div>
                            <div class="summary-value" id="total-records">0</div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="d-flex justify-between align-center mb-2">
                        <h2 class="card-title" style="margin: 0;">
                            <i class="fas fa-list"></i>
                            Histórico de Retiradas
                        </h2>
                        <button id="filter-records" class="btn btn-secondary btn-small">
                            <i class="fas fa-filter"></i> Filtrar
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Produto</th>
                                    <th>Qtd</th>
                                    <th>Setor</th>
                                    <th>Horário</th>
                                </tr>
                            </thead>
                            <tbody id="records-list">
                                <!-- Registros serão inseridos aqui via JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="empty-records" class="empty-state">
                        <i class="fas fa-clipboard-list"></i>
                        <p>Nenhuma retirada registrada</p>
                        <p class="text-muted" style="font-size: 14px; margin-top: 10px;">
                            As retiradas aparecerão aqui após serem cadastradas
                        </p>
                    </div>
                    
                    <div class="d-flex justify-between mt-2">
                        <button id="export-excel-btn" class="btn btn-secondary btn-small">
                            <i class="fas fa-file-excel"></i> Excel
                        </button>
                        <button id="export-pdf-btn" class="btn btn-secondary btn-small">
                            <i class="fas fa-file-pdf"></i> PDF
                        </button>
                        <button id="export-image-btn" class="btn btn-secondary btn-small">
                            <i class="fas fa-file-image"></i> Imagem
                        </button>
                        <button id="clear-records-btn" class="btn btn-danger btn-small">
                            <i class="fas fa-trash-alt"></i> Limpar
                        </button>
                    </div>
                </div>
            </section>

            <!-- TELA DE RELATÓRIOS -->
            <section id="reports-screen" class="screen">
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-chart-bar"></i>
                        Relatórios
                    </h2>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Relatórios por período</strong>
                            <p>Os dados são agrupados automaticamente conforme selecionado</p>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="report-period">Período</label>
                        <select id="report-period" class="form-control">
                            <option value="today">Hoje</option>
                            <option value="yesterday">Ontem</option>
                            <option value="week">Esta Semana</option>
                            <option value="month">Este Mês</option>
                            <option value="custom">Personalizado</option>
                        </select>
                    </div>
                    
                    <div id="custom-period" style="display: none;">
                        <div class="d-flex gap-2">
                            <div class="form-group" style="flex: 1;">
                                <label class="form-label" for="start-date">Data Inicial</label>
                                <input type="date" id="start-date" class="form-control">
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label class="form-label" for="end-date">Data Final</label>
                                <input type="date" id="end-date" class="form-control">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="group-by">Agrupar por</label>
                        <select id="group-by" class="form-control">
                            <option value="product">Produto</option>
                            <option value="sector">Setor</option>
                            <option value="employee">Colaborador</option>
                            <option value="hour">Hora do Dia</option>
                        </select>
                    </div>
                    
                    <div class="d-flex gap-2">
                        <button id="generate-report-btn" class="btn btn-primary" style="flex: 1;">
                            <i class="fas fa-chart-pie"></i>
                            Gerar
                        </button>
                        <button id="share-report-btn" class="btn btn-success" style="flex: 1;">
                            <i class="fas fa-share-alt"></i>
                            Compartilhar
                        </button>
                    </div>
                </div>
                
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-chart-line"></i>
                        Resumo do Relatório
                    </h2>
                    <div id="report-summary" class="text-muted text-center">
                        <p>Nenhum relatório gerado</p>
                        <p style="font-size: 14px;">Use o formulário acima para gerar um relatório</p>
                    </div>
                </div>

                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-file-alt"></i>
                        Relatório Detalhado
                    </h2>
                    <div id="report-content">
                        <!-- Conteúdo do relatório será inserido aqui -->
                    </div>
                </div>
            </section>

            <!-- TELA DE CONFIGURAÇÕES -->
            <section id="settings-screen" class="screen">
                <div class="card">
                    <h2 class="card-title">
                        <i class="fas fa-cog"></i>
                        Configurações
                    </h2>
                    
                    <div class="form-group">
                        <label class="form-label" for="company-name">Nome da Empresa</label>
                        <input type="text" id="company-name" class="form-control" placeholder="Nome da sua empresa" value="StockTrack">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="max-quantity">Quantidade Máxima</label>
                        <input type="number" id="max-quantity" class="form-control" value="9999" min="100" max="99999">
                        <div class="text-muted" style="font-size: 14px; margin-top: 5px;">
                            Define o limite máximo para retiradas por item
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="auto-save">Salvamento Automático</label>
                        <select id="auto-save" class="form-control">
                            <option value="enabled">Ativado</option>
                            <option value="disabled">Desativado</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="scan-sound">Som ao Escanear</label>
                        <select id="scan-sound" class="form-control">
                            <option value="enabled">Ativado</option>
                            <option value="disabled">Desativado</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="duplicate-time">Tempo mínimo entre registros</label>
                        <select id="duplicate-time" class="form-control">
                            <option value="1">1 minuto</option>
                            <option value="5">5 minutos</option>
                            <option value="15">15 minutos</option>
                            <option value="0">Sem restrição</option>
                        </select>
                        <div class="text-muted" style="font-size: 14px; margin-top: 5px;">
                            Evita registros duplicados acidentais
                        </div>
                    </div>
                    
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div>
                            <strong>Dados Locais</strong>
                            <p>Seus registros são armazenados apenas neste dispositivo</p>
                        </div>
                    </div>
                    
                    <button id="save-settings-btn" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Salvar Configurações
                    </button>
                    
                    <div class="d-flex gap-2 mt-2">
                        <button id="backup-data-btn" class="btn btn-secondary" style="flex: 1;">
                            <i class="fas fa-download"></i>
                            Backup
                        </button>
                        <button id="restore-data-btn" class="btn btn-secondary" style="flex: 1;">
                            <i class="fas fa-upload"></i>
                            Restaurar
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- MENU INFERIOR -->
        <nav class="bottom-nav">
            <div class="nav-item active" data-screen="register">
                <i class="fas fa-hand-holding nav-icon"></i>
                <span class="nav-label">Retirar</span>
            </div>
            <div class="nav-item" data-screen="records">
                <i class="fas fa-clipboard-list nav-icon"></i>
                <span class="nav-label">Histórico</span>
            </div>
            <div class="nav-item" data-screen="reports">
                <i class="fas fa-chart-bar nav-icon"></i>
                <span class="nav-label">Relatórios</span>
            </div>
            <div class="nav-item" data-screen="settings">
                <i class="fas fa-cog nav-icon"></i>
                <span class="nav-label">Configurações</span>
            </div>
        </nav>

        <!-- MODAL DO SCANNER -->
        <div id="scanner-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        <i class="fas fa-camera"></i>
                        Escanear Código de Barras
                    </h3>
                    <button class="modal-close" id="close-scanner">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info mb-2">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Como escanear</strong>
                            <p>Posicione o código de barras dentro do quadro</p>
                        </div>
                    </div>
                    
                    <div class="scanner-container">
                        <div id="qr-reader"></div>
                        <div class="scanner-overlay">
                            <div class="scanner-frame">
                                <div class="scanner-line"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-2">
                        <button id="toggle-camera" class="btn btn-secondary btn-small">
                            <i class="fas fa-sync-alt"></i>
                            Trocar Câmera
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- MODAL DE CONFIRMAÇÃO -->
        <div id="confirmation-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        <i class="fas fa-check-circle"></i>
                        Confirmação
                    </h3>
                </div>
                <div class="modal-body">
                    <div id="confirmation-message"></div>
                    <div class="d-flex gap-2 mt-3">
                        <button id="confirm-cancel" class="btn btn-secondary" style="flex: 1;">
                            Cancelar
                        </button>
                        <button id="confirm-ok" class="btn btn-primary" style="flex: 1;">
                            Confirmar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- MODAL DE FILTRO -->
        <div id="filter-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        <i class="fas fa-filter"></i>
                        Filtrar Registros
                    </h3>
                    <button class="modal-close" id="close-filter">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label" for="filter-sector">Setor</label>
                        <select id="filter-sector" class="form-control">
                            <option value="">Todos os setores</option>
                            <option value="estoque">Estoque</option>
                            <option value="loja">Loja</option>
                            <option value="producao">Produção</option>
                            <option value="expedicao">Expedição</option>
                            <option value="manutencao">Manutenção</option>
                            <option value="outro">Outro</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="filter-date">Data</label>
                        <select id="filter-date" class="form-control">
                            <option value="today">Hoje</option>
                            <option value="yesterday">Ontem</option>
                            <option value="week">Esta semana</option>
                            <option value="month">Este mês</option>
                            <option value="all">Todo período</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="filter-employee">Colaborador</label>
                        <input type="text" id="filter-employee" class="form-control" placeholder="Filtrar por colaborador">
                    </div>
                    
                    <div class="d-flex gap-2">
                        <button id="apply-filter" class="btn btn-primary" style="flex: 1;">
                            <i class="fas fa-check"></i>
                            Aplicar
                        </button>
                        <button id="clear-filter" class="btn btn-secondary" style="flex: 1;">
                            <i class="fas fa-times"></i>
                            Limpar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- FAB PARA ADICIONAR REGISTRO RÁPIDO -->
        <button id="fab-add" class="fab-button">
            <i class="fas fa-plus"></i>
        </button>
    </div>

    <script src="scanner.js"></script>
    <script src="reports.js"></script>
    <script src="app.js"></script>
</body>
</html>